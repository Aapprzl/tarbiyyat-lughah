<!DOCTYPE html>
<html lang="id" dir="ltr" class="scroll-smooth overflow-x-hidden">

<script src="assets/data/materials.js"></script>

<script src="https://unpkg.com/feather-icons"></script>
<script>feather.replace()</script>



<script src="assets/theme.js"></script>

  <!-- INTRO REDIRECT LOGIC (3 HOURS EXPIRE) -->
  <script>
    (function () {
      try {
        const lastSeen = localStorage.getItem("lastIntroSeen");
        const threeHours = 3 * 60 * 60 * 1000; // 3 jam dalam ms
        const now = Date.now();

        if (!lastSeen || (now - Number(lastSeen) > threeHours)) {
          // Cegah redirect loop jika sudah di intro (sebenarnya ini file index, jadi aman)
          window.location.replace("intro.html");
        }
      } catch (e) {
        console.error("Redirect check failed", e);
      }
    })();
  </script>


<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tarbiyyat Al-Lughah â€” Pembelajaran Membaca Bahasa Arab MTs</title>

  <!-- Favicons -->
  <link rel="icon" type="image/png" href="icons/icon-192.png">
  <link rel="apple-touch-icon" href="icons/icon-192.png">

  <!-- SEO Schema (Google Logo) -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "Tarbiyyat Al-Lughah",
    "url": "https://tarbiyyatallughah.com",
    "logo": "https://tarbiyyatallughah.com/icons/icon-512.png",
    "sameAs": []
  }
  </script>


  <!-- Fonts & Tailwind -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link
    href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&display=swap"
    rel="stylesheet">
  <link href="assets/css/styles.css" rel="stylesheet">
  <!-- AOS Animation Library -->
  <link rel="stylesheet" href="assets/vendor/aos/aos.css" />

  <!-- CSS moved to input.css -->



  <!-- CSS moved to input.css -->




  <link rel="manifest" href="/manifest.webmanifest">
  <meta name="theme-color" content="#0f766e">



</head>

<body
  class="min-h-screen flex flex-col font-sans antialiased text-slate-700 dark:text-slate-100 selection:bg-amber-300 selection:text-amber-900 overflow-x-hidden bg-slate-50 dark:bg-slate-900 relative">

  <!-- BACKGROUND GLOBAL (FIXED) -->
  <div class="fixed inset-0 z-0 pointer-events-none overflow-hidden">
    <!-- Teal Blob (Top Left) -->
    <div class="absolute top-[-10%] left-[-10%] w-[50%] h-[50%] bg-teal-500/10 rounded-full blur-[100px] animate-pulse">
    </div>
    <!-- Cyan Blob (Bottom Right) -->
    <div class="absolute bottom-[-10%] right-[-10%] w-[50%] h-[50%] bg-cyan-500/10 rounded-full blur-[100px] animate-pulse" style="animation-delay: 2s;">
    </div>
    <!-- Additional Center Blob for extra vibes -->
    <div class="absolute top-[40%] left-[30%] w-[40%] h-[40%] bg-blue-500/5 rounded-full blur-[120px] animate-pulse" style="animation-delay: 4s;">
    </div>
  </div>

  <!-- Header -->
  <header
    class="sticky top-0 z-[100] w-full bg-blue-700/95 dark:bg-slate-900/95 backdrop-blur-md text-white shadow-lg border-b border-white/10 transition-all">
    <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">

      <a href="index.html" class="flex items-center gap-3 group cursor-pointer">
        <div class="bg-white/20 p-2 rounded-xl backdrop-blur-sm group-hover:bg-white/30 transition-all shadow-inner">
          <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-yellow-300" fill="none" viewBox="0 0 24 24"
            stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
              d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" />
          </svg>
        </div>
        <div class="flex flex-col">
          <span class="text-xl font-black tracking-tight leading-none italic uppercase">Tarbiyyat</span>
          <span
            class="text-[10px] font-bold tracking-[0.2em] text-blue-200 uppercase leading-none mt-1">al-Lughah</span>
        </div>
      </a>

      <div class="flex items-center gap-4 md:gap-8">

        <nav class="hidden md:flex items-center gap-8">
          <a href="#materi" class="relative text-sm font-bold text-white/80 hover:text-white transition-colors group">
            Materi
            <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-yellow-400 transition-all group-hover:w-full"></span>
          </a>
          <a href="#dashboard-siswa"
            class="relative text-sm font-bold text-white/80 hover:text-white transition-colors group">
            Login Akun
            <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-yellow-400 transition-all group-hover:w-full"></span>
          </a>
          <a href="#library" class="relative text-sm font-bold text-white/80 hover:text-white transition-colors group">
            E-Book
            <span class="absolute -bottom-1 left-0 w-0 h-0.5 bg-yellow-400 transition-all group-hover:w-full"></span>
          </a>
        </nav>

        <div class="hidden md:block w-px h-6 bg-white/20"></div>

        <div class="flex items-center gap-3">
          <button id="themeToggle" class="flex items-center justify-center w-10 h-10 rounded-xl 
                 bg-white/10 hover:bg-white/20 border border-white/20
                 transition-all active:scale-90 text-lg shadow-sm" title="Ganti Tema">
            ğŸŒ™
          </button>

          <button id="mobile-menu-btn"
            class="md:hidden p-2 rounded-xl bg-white/10 hover:bg-white/20 active:bg-white/30 transition-all">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
            </svg>
          </button>
        </div>
      </div>

    </div>

    <div id="mobile-menu" class="hidden md:hidden absolute top-full left-0 w-full z-50">

      <div
        class="bg-blue-900/95 dark:bg-slate-900/95 backdrop-blur-xl border-t border-white/10 shadow-2xl rounded-b-[2rem] overflow-hidden">

        <div
          class="absolute top-0 right-0 w-32 h-32 bg-blue-500/20 rounded-full blur-3xl pointer-events-none -translate-y-1/2 translate-x-1/2">
        </div>

        <nav class="flex flex-col p-6 space-y-3 relative z-10">

          <a href="#materi"
            class="mobile-link group flex items-center justify-between p-4 rounded-2xl bg-white/5 border border-white/5 hover:bg-white/10 hover:border-white/20 transition-all duration-300 active:scale-95">
            <div class="flex items-center gap-3">
              <span class="w-8 h-8 flex items-center justify-center bg-blue-500/20 rounded-lg text-lg">ğŸ“š</span>
              <span class="text-sm font-bold text-white tracking-wide">Materi Pelajaran</span>
            </div>
            <svg xmlns="http://www.w3.org/2000/svg"
              class="w-4 h-4 text-white/40 group-hover:text-white group-hover:translate-x-1 transition-all" fill="none"
              viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </a>



          <a href="#library"
            class="mobile-link group flex items-center justify-between p-4 rounded-2xl bg-white/5 border border-white/5 hover:bg-white/10 hover:border-white/20 transition-all duration-300 active:scale-95">
            <div class="flex items-center gap-3">
              <span class="w-8 h-8 flex items-center justify-center bg-emerald-500/20 rounded-lg text-lg">ğŸ“–</span>
              <span class="text-sm font-bold text-white tracking-wide">Perpustakaan</span>
            </div>
            <svg xmlns="http://www.w3.org/2000/svg"
              class="w-4 h-4 text-white/40 group-hover:text-white group-hover:translate-x-1 transition-all" fill="none"
              viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </a>


          
          <a href="#dashboard-siswa"
            class="mobile-link group flex items-center justify-between p-4 rounded-2xl bg-white/5 border border-white/5 hover:bg-white/10 hover:border-white/20 transition-all duration-300 active:scale-95">
            <div class="flex items-center gap-3">
              <span class="w-8 h-8 flex items-center justify-center bg-rose-500/20 rounded-lg text-lg">ğŸ”</span>
              <span class="text-sm font-bold text-white tracking-wide">Masuk Akun</span>
            </div>
            <svg xmlns="http://www.w3.org/2000/svg"
              class="w-4 h-4 text-white/40 group-hover:text-white group-hover:translate-x-1 transition-all" fill="none"
              viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
            </svg>
          </a>

        </nav>

        <div class="px-6 pb-6 text-center">
          <p class="text-[10px] text-white/30 font-bold uppercase tracking-widest">
            Tarbiyyat al-Lughah App
          </p>
        </div>

      </div>
    </div>

  </header>


  <!-- HERO MINIMAL â€“ TARBIYYAT AL-LUGHAH -->
  <section class="relative w-full overflow-hidden bg-transparent py-16 md:py-24 z-10" data-aos="fade-up">

    <div class="relative max-w-7xl mx-auto px-6 grid grid-cols-1 md:grid-cols-2 gap-12 items-center">

      <div class="space-y-8 text-center md:text-left">
        <div
          class="inline-flex items-center gap-2 px-4 py-2 rounded-2xl glass-card shadow-sm border border-slate-200 dark:border-slate-700">
          <span class="relative flex h-3 w-3">
            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-teal-400 opacity-75"></span>
            <span class="relative inline-flex rounded-full h-3 w-3 bg-teal-500"></span>
          </span>
          <span class="text-xs font-bold tracking-widest text-teal-600 dark:text-teal-400 uppercase">
            Next-Gen E-Learning
          </span>
        </div>

        <h1 class="font-black tracking-tight text-slate-900 dark:text-white leading-[1.1]">
          <span class="block text-5xl md:text-7xl mb-2">
            Belajar <span class="text-gradient">Bahasa Arab</span>
          </span>
          <span class="block text-2xl md:text-4xl text-slate-500 dark:text-slate-400 font-bold">
            Jadi Lebih Menyenangkan! âš¡
          </span>
        </h1>

        <p class="text-slate-600 dark:text-slate-400 text-lg md:text-xl max-w-xl mx-auto md:mx-0">
          Solusi belajar Bahasa Arab interaktif untuk siswa MTs. Belajar dengan metode <span
            class="text-teal-600 font-bold italic underline decoration-wavy">Interaktif.</span> Lebih mudah dipahami, lebih cepat dikuasai, dan tentunya lebih seru!
        </p>

        <div class="flex flex-wrap justify-center md:justify-start gap-5 pt-4">
          <a href="grammar-basics.html"
            class="hidden md:inline-flex group relative items-center gap-3 px-10 py-5 rounded-2xl bg-gradient-to-r from-blue-600 to-indigo-600 text-white font-black text-xl shadow-2xl shadow-blue-500/30 transition-all hover:scale-105 active:scale-95 overflow-hidden ring-4 ring-white/20 dark:ring-white/10">
            
            <span class="absolute inset-0 bg-white/20 translate-y-full group-hover:translate-y-0 transition-transform duration-300"></span>
            <span class="relative z-10 flex items-center gap-2">
               ğŸš€ Materi Gramatikal Dasar
            </span>
            <span class="relative z-10 flex h-3 w-3">
                <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-yellow-400 opacity-75"></span>
                <span class="relative inline-flex rounded-full h-3 w-3 bg-yellow-500"></span>
            </span>
          </a>
        </div>
      </div>

      <div class="relative animate-float">
        <div class="absolute -top-10 -right-10 w-24 h-24 bg-yellow-400/20 rounded-full blur-xl animate-bounce"></div>

        <div
          class="glass-card p-10 md:p-14 rounded-[3rem] shadow-2xl border border-white/50 relative z-10 overflow-hidden">
          <!-- DISPLAY DESKTOP: LOGO BOX -->
          <div class="hidden md:block">
             <div class="absolute -bottom-5 -left-5 opacity-[0.03] text-9xl font-arabic pointer-events-none">
              Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
            </div>

            <div class="text-center space-y-6">
              <img src="icons/icon-192.png" alt="Logo" class="w-24 h-24 md:w-28 md:h-28 object-contain drop-shadow-xl hover:scale-105 transition-transform duration-300 mb-6 mx-auto">

              <h2 class="text-4xl md:text-5xl font-black text-slate-900 dark:text-white tracking-tighter leading-tight">
                Tarbiyyat <br /> <span class="text-blue-600">Al-Lughah</span>
              </h2>

              <p class="font-arabic text-5xl md:text-6xl py-4 text-slate-700 dark:text-slate-200 leading-relaxed tracking-wide drop-shadow-sm"
                dir="rtl">
                Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ù„ØºÙˆÙŠØ©
              </p>

              <div class="h-1.5 w-24 bg-blue-600 mx-auto rounded-full"></div>
            </div>
          </div>

          <!-- DISPLAY MOBILE: BUTTON GRAMMAR CARD (INITIAL VERSION) -->
          <div class="block md:hidden">
              <a href="grammar-basics.html" class="flex flex-col items-center justify-center text-center space-y-4 py-8 group active:scale-95 transition-transform">
                  
                  <div class="relative w-24 h-24 bg-gradient-to-tr from-blue-100 to-indigo-100 dark:from-slate-700 dark:to-slate-800 rounded-full flex items-center justify-center mb-2 shadow-inner ring-4 ring-white dark:ring-slate-700">
                      <span class="text-4xl animate-bounce">ğŸš€</span>
                      
                      <!-- Pulse Effect -->
                      <span class="absolute top-0 right-0 -mt-1 -mr-1 flex h-6 w-6">
                        <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-yellow-400 opacity-75"></span>
                        <span class="relative inline-flex rounded-full h-6 w-6 bg-yellow-500 border-2 border-white"></span>
                      </span>
                  </div>

                  <div>
                    <h3 class="text-2xl font-black text-slate-800 dark:text-white leading-none mb-1">
                      Materi <span class="text-blue-600">Gramatikal</span>
                    </h3>
                    <p class="text-xs font-bold text-slate-400 uppercase tracking-widest">
                       Klik untuk Mulai Belajar
                    </p>
                  </div>

                  <div class="mt-2 text-blue-600 dark:text-blue-400">
                      <svg xmlns="http://www.w3.org/2000/svg" class="h-8 w-8 animate-pulse" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2"> <!-- Arrow Icon -->
                        <path stroke-linecap="round" stroke-linejoin="round" d="M13 5l7 7-7 7M5 5l7 7-7 7" />
                      </svg>
                  </div>
              </a>
          </div>
        </div>
      </div>

    </div>
  </section>


  <!-- GAMES GRAMATIKAL -->

  <section id="game-area" class="max-w-7xl mx-auto px-4 py-12 mb-14">

    <div class="relative bg-white dark:bg-slate-800
              rounded-[2.5rem] border-4 border-slate-200 dark:border-slate-700
              p-6 md:p-10 shadow-xl overflow-hidden
              min-h-[420px] md:min-h-[360px]">

      <!-- Accent -->
      <div class="absolute top-0 left-0 w-full h-2 bg-gradient-to-r from-blue-400 via-indigo-500 to-purple-500"></div>
      <div class="absolute -left-10 top-10 text-9xl opacity-5 pointer-events-none rotate-12">ğŸ®</div>
      <div class="absolute -right-10 bottom-10 text-9xl opacity-5 pointer-events-none -rotate-12">ğŸ†</div>

      <!-- MAIN GRID -->
      <div class="grid grid-cols-1 lg:grid-cols-[1.2fr_2fr] gap-10 items-center relative z-10">

        <!-- LEFT : INFO PANEL -->
        <div class="flex flex-col gap-6">
          <div class="flex items-center justify-between">
            <span
              class="inline-flex items-center gap-1.5 px-3 py-1 text-[10px] md:text-xs font-black uppercase tracking-[0.2em] bg-blue-100 text-blue-600 rounded-full shadow-sm">
              <span>ğŸ®</span> Game Gramatikal
            </span>

            <button onclick="resetGame()"
              class="text-xs font-bold text-slate-400 hover:text-rose-500 transition-colors">
              Reset
            </button>
          </div>

          <h2 class="text-2xl md:text-4xl font-black text-slate-800 dark:text-white mb-2">
            ğŸ§© Tebak <span class="text-blue-600">Jenis Kata</span>
          </h2>

          <!-- SCORE BAR -->
          <div class="flex gap-8 items-end">
            <div>
              <p class="text-xs font-bold text-slate-400 uppercase">Skor</p>
              <p id="score-val" class="text-3xl font-black text-slate-800 dark:text-white">0</p>
            </div>

            <div
              class="bg-slate-100 dark:bg-slate-700 px-5 py-2 rounded-2xl border-2 border-slate-200 dark:border-slate-600 shadow-sm">
              <p class="text-xs font-bold text-slate-400 uppercase mb-1">Waktu</p>
              <div class="flex items-center gap-1 text-2xl font-black text-slate-800 dark:text-white">
                â³ <span id="timer-val">60</span>s
              </div>
            </div>

            <div>
              <p class="text-xs font-bold text-slate-400 uppercase">Combo</p>
              <p id="combo-val" class="text-3xl font-black text-amber-500">x0</p>
            </div>
          </div>

          <p class="text-slate-500 dark:text-slate-400 text-sm max-w-sm leading-relaxed">
            Pilih jenis kata (Isim/Fi'il/Harf) yang sesuai. Waktu akan berjalan otomatis saat Anda mulai menjawab.
          </p>
        </div>

        <!-- RIGHT : GAME AREA -->
        <div>

          <!-- WORD DISPLAY -->
          <div class="h-56 md:h-64 w-full flex items-center justify-center
                    bg-slate-50 dark:bg-slate-900
                    rounded-[2rem] border-2 border-dashed
                    border-slate-300 dark:border-slate-700
                    mb-6 shadow-inner relative overflow-hidden">

            <div id="game-word" class="font-arab text-6xl md:text-8xl font-bold
                      text-slate-800 dark:text-slate-100
                      transition-all duration-200 text-center px-4">
              ...
            </div>

            <div id="game-feedback" class="absolute inset-0 flex items-center justify-center
                      text-7xl font-black opacity-0
                      pointer-events-none transition-all duration-300 scale-50">
              âœ…
            </div>
          </div>

          <!-- ANSWER BUTTONS -->
          <div class="grid grid-cols-3 gap-4 md:gap-6">

            <button onclick="checkAnswer('isim')" class="game-btn bg-blue-100 hover:bg-blue-200 text-blue-700
                   border-b-4 border-blue-300 hover:border-blue-400
                   rounded-2xl py-5 md:py-7
                   font-black text-sm md:text-xl
                   transition-transform active:scale-95 active:translate-y-1 shadow-sm">
              ISIM
              <span class="hidden md:block text-xs font-normal opacity-60 mt-1">Kata Benda</span>
            </button>

            <button onclick="checkAnswer('fiil')" class="game-btn bg-rose-100 hover:bg-rose-200 text-rose-700
                   border-b-4 border-rose-300 hover:border-rose-400
                   rounded-2xl py-5 md:py-7
                   font-black text-sm md:text-xl
                   transition-transform active:scale-95 active:translate-y-1 shadow-sm">
              FI'IL
              <span class="hidden md:block text-xs font-normal opacity-60 mt-1">Kata Kerja</span>
            </button>

            <button onclick="checkAnswer('harf')" class="game-btn bg-emerald-100 hover:bg-emerald-200 text-emerald-700
                   border-b-4 border-emerald-300 hover:border-emerald-400
                   rounded-2xl py-5 md:py-7
                   font-black text-sm md:text-xl
                   transition-transform active:scale-95 active:translate-y-1 shadow-sm">
              HARF
              <span class="hidden md:block text-xs font-normal opacity-60 mt-1">Huruf</span>
            </button>

          </div>
        </div>
      </div>

      <!-- OVERLAY (Hanya Muncul Saat Game Over) -->
      <div id="game-overlay" class="absolute inset-0 z-50 bg-white/95 dark:bg-slate-900/95
                flex flex-col items-center justify-center text-center p-6
                backdrop-blur-sm transition-opacity duration-300 opacity-0 pointer-events-none">

        <!-- Konten Overlay Diisi JS saat Game Over -->
        <div class="mb-6 text-7xl animate-bounce">ğŸ</div>
        <h2 id="overlay-title" class="text-3xl md:text-4xl font-black text-slate-800 dark:text-white mb-2"></h2>
        <p id="overlay-desc" class="text-slate-500 dark:text-slate-400 mb-8 max-w-sm text-lg"></p>

        <button onclick="resetGame()" class="px-10 py-4 rounded-full
               bg-gradient-to-r from-blue-600 to-indigo-600
               text-white font-bold text-lg
               shadow-xl shadow-blue-500/30
               hover:shadow-blue-500/50 hover:scale-105 transition-all">
          Main Lagi ğŸ”„
        </button>
      </div>

    </div>
  </section>

  <!-- GAME GRAMATIKAL LOGIC -->
  <script type="module">
    import { db, collection, getDocs } from './assets/js/firebase-config.js';

    document.addEventListener('DOMContentLoaded', async () => {
      const gameWord = document.getElementById('game-word');
      const scoreEl = document.getElementById('score-val');
      const timerEl = document.getElementById('timer-val');
      const comboEl = document.getElementById('combo-val');
      const feedbackEl = document.getElementById('game-feedback');
      const overlay = document.getElementById('game-overlay');
      const overlayTitle = document.getElementById('overlay-title');
      const overlayDesc = document.getElementById('overlay-desc');

      if (!gameWord || !scoreEl) return;

      let questions = [];

      // Initial Data Load
      try {
        const snap = await getDocs(collection(db, "grammar_questions"));
        snap.forEach(doc => questions.push(doc.data()));
        console.log("Grammar Game Firestore Data Loaded:", questions.length);
      } catch (e) {
        console.error("Firestore Loading Error:", e);
        // Fallback basics if Firestore fails
        questions = [
          { word: "ÙƒÙØªÙØ§Ø¨ÙŒ", type: "isim" }, { word: "ÙŠÙÙƒÙ’ØªÙØ¨Ù", type: "fiil" }, { word: "ÙÙÙŠ", type: "harf" }
        ];
      }

      let currentQuestion = null;
      let score = 0;
      let combo = 0;
      let timer = 60;
      let timerInterval = null;
      let isPlaying = false;
      let gameStarted = false;

      function updateDisplay() {
        scoreEl.innerText = score;
        comboEl.innerText = 'x' + combo;
        timerEl.innerText = timer;
      }

      function loadQuestion() {
        if (questions.length === 0) {
          gameWord.innerText = "...";
          return;
        }
        const rand = Math.floor(Math.random() * questions.length);
        currentQuestion = questions[rand];
        gameWord.innerText = currentQuestion.word;
      }

      function startTimer() {
        if (timerInterval) clearInterval(timerInterval);
        timerInterval = setInterval(() => {
          timer--;
          timerEl.innerText = timer;
          if (timer <= 10) {
            timerEl.parentElement.classList.add('text-red-500');
          }
          if (timer <= 0) {
            endGame();
          }
        }, 1000);
      }

      function endGame() {
        isPlaying = false;
        gameStarted = false;
        clearInterval(timerInterval);
        
        overlayTitle.innerText = "ğŸ Game Selesai!";
        overlayDesc.innerHTML = `Skor Akhir: <span class="text-4xl font-black text-blue-600 block mt-2">${score}</span>`;
        overlay.classList.remove('opacity-0', 'pointer-events-none');
      }

      function showFeedback(isCorrect) {
        feedbackEl.innerText = isCorrect ? 'âœ…' : 'âŒ';
        feedbackEl.classList.remove('opacity-0', 'scale-50');
        feedbackEl.classList.add('opacity-100', 'scale-100');
        setTimeout(() => {
          feedbackEl.classList.remove('opacity-100', 'scale-100');
          feedbackEl.classList.add('opacity-0', 'scale-50');
        }, 400);
      }

      window.resetGame = function() {
        if (timerInterval) clearInterval(timerInterval);
        score = 0;
        combo = 0;
        timer = 60;
        isPlaying = true;
        gameStarted = false; // Menunggu interaksi pertama
        
        updateDisplay();
        timerEl.parentElement.classList.remove('text-red-500');
        overlay.classList.add('opacity-0', 'pointer-events-none');
        
        loadQuestion();
        // Timer tidak langsung jalan
      };

      window.checkAnswer = function(type) {
        // Auto-init jika belum pernah main
        if (!isPlaying && !gameStarted) {
            window.resetGame();
        }

        if (!isPlaying) return;

        // Mulai timer saat user pertama kali klik jawaban
        if (!gameStarted) {
            gameStarted = true;
            startTimer();
        }

        if (!currentQuestion) return;

        if (type === currentQuestion.type) {
          score += 10 + (combo * 2);
          combo++;
          showFeedback(true);
        } else {
          combo = 0;
          showFeedback(false);
        }

        updateDisplay();
        loadQuestion();
      };

      // Initial load
      loadQuestion();
    });
  </script>


  <!-- ===============================
     GAME MENYUSUN KALIMAT (FINAL)
================================ -->
  <section id="sentence-game" class="scroll-mt-28 max-w-6xl mx-auto px-4 mt-12 mb-24">

    <div class="relative bg-white dark:bg-slate-800 
              rounded-[2.5rem] 
              border-4 border-slate-200 dark:border-slate-700 
              shadow-xl overflow-hidden 
              p-6 md:p-10">

      <div class="absolute top-0 left-0 w-full h-2 
                bg-gradient-to-r from-emerald-400 via-blue-500 to-indigo-500"></div>

      <div class="text-center mb-10">
        <span class="inline-block px-4 py-1.5 mb-4 
                   text-[10px] font-black uppercase tracking-[0.3em] 
                   bg-blue-100 dark:bg-blue-900/30 
                   text-blue-600 dark:text-blue-400 
                   rounded-full">
          Game Gramatikal
        </span>

        <h2 class="text-2xl md:text-4xl font-black text-slate-800 dark:text-white mb-2">
          ğŸ§© Susun <span class="text-blue-600">Kalimat Arab</span>
        </h2>

        <h3 id="current-level-title" class="text-lg font-bold text-emerald-600 dark:text-emerald-400 mb-2">
        </h3>

        <div
          class="bg-slate-50 dark:bg-slate-900/50 rounded-2xl p-4 max-w-2xl mx-auto border border-slate-100 dark:border-slate-700">
          <p id="current-level-description" class="text-slate-600 dark:text-slate-300 text-sm md:text-base italic">
          </p>
        </div>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-2 gap-10 items-start">

        <div dir="rtl">
          <p class="text-xs font-bold uppercase text-slate-400 mb-2 text-right">
            Kata Acak (Pilih Kata)
          </p>
          <div id="word-bank" class="flex flex-wrap gap-3 justify-center 
                    bg-slate-50 dark:bg-slate-900 
                    border-2 border-dashed 
                    border-slate-300 dark:border-slate-700 
                    rounded-2xl p-4 
                    min-h-[90px]">
          </div>
        </div>

        <div dir="rtl">
          <p class="text-xs font-bold uppercase text-slate-400 mb-2 text-right">
            Susunan Kalimat (Urutan Kanan ke Kiri)
          </p>
          <div id="drop-zone" class="flex flex-wrap gap-3 justify-center 
                    bg-white dark:bg-slate-800 
                    border-2 border-slate-300 dark:border-slate-600 
                    rounded-2xl p-4 
                    min-h-[100px]">
          </div>
          <p class="mt-3 text-xs text-slate-400 text-center" dir="ltr">
            ğŸ’¡ Tips: Klik kata di atas untuk memindahkan ke zona susunan.
          </p>
        </div>

      </div>

      <div class="mt-12 text-center">
        <button onclick="checkSentence()" class="px-10 py-4 rounded-full 
                     bg-gradient-to-r from-blue-600 to-indigo-600 
                     text-white font-bold text-lg 
                     shadow-xl shadow-blue-500/30 
                     hover:shadow-blue-500/50 hover:scale-105 
                     transition">
          âœ… Cek Jawaban
        </button>
      </div>

      <div id="sentence-feedback" class="mt-6 text-center text-lg font-black 
                opacity-0 transition-all duration-300">
      </div>

    </div>
  </section>



  <!-- ===============================
     GAME HARAKAT (LENGKAPI HARAKAT)
================================ -->
  <section id="harakat-game" class="scroll-mt-28 w-full px-4 mt-8 mb-24 md:mt-14">
    <div id="harakat-game-wrapper">
      <div class="relative bg-pattern rounded-[2rem] md:rounded-[2.5rem]
                border-4 border-slate-200 dark:border-slate-700
                shadow-2xl overflow-hidden
                max-w-4xl mx-auto
                relative"> <!-- Added relative for positioning accent -->

        <!-- Accent Top Bar -->
        <div class="absolute top-0 left-0 w-full h-2 z-20
          bg-gradient-to-r from-amber-400 via-orange-500 to-rose-500"></div>

        <div
          class="absolute -top-20 -left-20 w-40 h-40 bg-amber-400 rounded-full mix-blend-multiply filter blur-3xl opacity-20 dark:opacity-10 animate-blob">
        </div>
        <div
          class="absolute -top-20 -right-20 w-40 h-40 bg-orange-400 rounded-full mix-blend-multiply filter blur-3xl opacity-20 dark:opacity-10 animate-blob animation-delay-2000">
        </div>

        <div class="relative p-4 md:p-10 backdrop-blur-sm z-10">

          <div class="text-center mb-8 md:mb-10">


            <h2 class="text-2xl md:text-4xl font-black text-slate-800 dark:text-white mb-3">
              âœï¸ Lengkapi <span
                class="text-transparent bg-clip-text bg-gradient-to-r from-amber-500 to-orange-600">Harakat</span>
            </h2>

            <p class="text-slate-500 dark:text-slate-400 text-sm md:text-base max-w-lg mx-auto leading-relaxed">
              Uji kemampuan bahasa Arabmu dengan mengisi harakat yang hilang pada kata di bawah ini.
            </p>
          </div>

          <div class="max-w-2xl mx-auto space-y-8">

            <div id="harakat-board" class="grid gap-4 md:gap-6 md:grid-cols-2 items-stretch">

              <!-- KOLOM KIRI : SOAL -->
              <div class="flex flex-col min-w-0">

                <!-- HEADER SOAL -->
                <div class="flex items-center justify-between mb-2 px-2">
                  <label class="text-xs font-bold uppercase text-slate-400">
                    Soal
                  </label>

                  <button id="shuffle-question" class="flex items-center gap-1.5 px-3 py-1.5
               text-xs font-bold rounded-full
               bg-slate-100 dark:bg-slate-700
               text-slate-600 dark:text-slate-300
               hover:bg-amber-100 hover:text-amber-600
               transition-all active:scale-95">
                    ğŸ”€ Acak
                  </button>
                </div>

                <!-- BOX SOAL -->
                <div id="harakat-question" class="arabic-input
                  text-center
                  font-arab text-4xl md:text-6xl font-bold
                  leading-[1.3]
                  text-slate-700 dark:text-slate-200
                  bg-white dark:bg-slate-800
                  border-2 border-dashed border-slate-300 dark:border-slate-600
                  rounded-2xl
                  py-3 px-4
                  shadow-sm
                  min-h-[80px]
                  break-words max-w-full overflow-hidden">
                  ...
                </div>

              </div>

              <!-- KOLOM KANAN : JAWABAN -->
              <div class="flex flex-col min-w-0">
                <label class="text-xs font-bold uppercase text-slate-400 mb-2 pl-2">
                  Jawabanmu
                </label>

                <input id="harakat-input" type="text" inputmode="none" dir="rtl" placeholder="....." class="arabic-input flex-1 text-center font-arab
                  text-3xl md:text-5xl placeholder-slate-300 dark:placeholder-slate-600
                  py-3 px-4 rounded-2xl
                  bg-white dark:bg-slate-800
                  border-2 border-slate-300 dark:border-slate-600
                  focus:border-amber-500 focus:ring-4 focus:ring-amber-500/10
                  outline-none transition-all duration-300
                  min-h-[80px] md:min-h-[100px]
                  w-full min-w-0"
                  />
                
                <!-- Feedback langsung di bawah input -->
                <div id="harakat-feedback" class="hidden mt-2 py-2 px-4 rounded-lg text-sm font-bold text-center transition-all"></div>
              </div>

            </div>


            <div class="flex justify-center" style="margin-top: 76px;">
              <button id="toggle-keyboard"
                class="group relative inline-flex items-center gap-2 px-6 py-2.5 rounded-full
                                   bg-slate-100 dark:bg-slate-700/50 
                                   hover:bg-amber-100 dark:hover:bg-slate-700
                                   text-slate-600 dark:text-slate-300 hover:text-amber-600
                                   font-bold text-xs md:text-sm transition-all border border-transparent hover:border-amber-200">
                <span class="text-lg">âŒ¨ï¸</span>
                <span>Tampilkan Keyboard Arab</span>
                <svg class="w-4 h-4 transition-transform group-[.active]:rotate-180" fill="none" stroke="currentColor"
                  viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                </svg>
              </button>
            </div>




            <div class="text-center pt-2">
              <button onclick="checkHarakatAnswer()" class="relative inline-flex items-center justify-center gap-2
                                   w-full md:w-auto md:px-16 py-4 rounded-xl
                                   bg-gradient-to-b from-amber-400 to-orange-500
                                   border-b-4 border-orange-700
                                   text-white font-black text-lg tracking-wide
                                   shadow-lg shadow-orange-500/30
                                   active:border-b-0 active:translate-y-1 active:shadow-none
                                   hover:brightness-110 transition-all">
                <span>CEK JAWABAN</span>
                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                </svg>
              </button>
            </div>

          </div>
        </div>
      </div>

      <!-- POPUP BENAR -->
      <!-- Style untuk Popup Benar -->
      <style>
        #harakat-correct-popup.active {
          opacity: 1 !important;
          pointer-events: auto !important;
        }

        #harakat-correct-popup.active>div {
          transform: scale(1) !important;
        }
      </style>
      <div id="harakat-correct-popup" class="fixed inset-0 z-[999]
            flex items-center justify-center
            bg-black/40 backdrop-blur-sm
            opacity-0 pointer-events-none
            transition-all duration-300">

        <div class="bg-white dark:bg-slate-800
              rounded-3xl
              px-10 py-8
              text-center
              shadow-2xl
              scale-75
              transition-all duration-300">

          <div class="text-6xl mb-4 animate-bounce">ğŸ‰</div>

          <p class="text-2xl font-black text-emerald-600 mb-1">
            Jawaban Benar!
          </p>

          <p class="text-slate-500 dark:text-slate-400 text-sm">
            Harakat sudah tepat
          </p>

        </div>
      </div>
    </div>
  </section>



  <!-- Kartu Kosakata (Flip Cards) -->
  <section id="flashcards" class="scroll-mt-28 w-full px-4 mt-12 mb-20">
    <div id="flashcards-wrapper">
      <div class="relative bg-white dark:bg-slate-800 
                rounded-[2rem] md:rounded-[2.5rem]
                border-4 border-slate-200 dark:border-slate-700 
                shadow-xl overflow-hidden 
                max-w-4xl mx-auto
                p-6 md:p-10">

      <!-- Accent Top Bar -->
      <div class="absolute top-0 left-0 w-full h-3 
                bg-gradient-to-r from-teal-400 via-cyan-500 to-blue-500"></div>
      
      <!-- Background Blobs -->
      <div class="absolute top-[-10%] right-[-5%] w-64 h-64 bg-cyan-400/10 rounded-full blur-3xl pointer-events-none"></div>
      <div class="absolute bottom-[-10%] left-[-5%] w-64 h-64 bg-teal-400/10 rounded-full blur-3xl pointer-events-none"></div>


      <div class="text-center mb-10 relative z-10">
        <span class="inline-block px-4 py-1.5 mb-4 
                   text-[10px] font-black uppercase tracking-[0.3em] 
                   bg-cyan-100 dark:bg-cyan-900/30 
                   text-cyan-700 dark:text-cyan-400 
                   rounded-full">
          Hafalan Harian
        </span>

        <h2 class="text-2xl md:text-4xl font-black text-slate-800 dark:text-white mb-2 flex items-center justify-center gap-3">
          <span class="text-4xl">ğŸƒ</span> Kartu <span class="text-transparent bg-clip-text bg-gradient-to-r from-teal-600 to-cyan-600">Kosakata</span>
        </h2>
        
        <p class="text-slate-500 dark:text-slate-400 mt-2 font-medium max-w-lg mx-auto">
          Ketuk kartu untuk melihat jawaban. Latih ingatanmu setiap hari!
        </p>

        <!-- Mode Toggles -->
        <div class="flex items-center justify-center gap-2 mt-6">
          <div class="p-1.5 bg-slate-100 dark:bg-slate-900/50 rounded-2xl border border-slate-200 dark:border-slate-700 inline-flex">
            <button id="mode-ar"
              class="px-6 py-2.5 rounded-xl text-xs md:text-sm font-black transition-all duration-300 
                     bg-white dark:bg-teal-600 text-teal-700 dark:text-white shadow-md scale-100">
              AR â” ID
            </button>
            <button id="mode-id"
              class="px-6 py-2.5 rounded-xl text-xs md:text-sm font-bold transition-all duration-300 
                     text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200">
              ID â” AR
            </button>
          </div>
        </div>
      </div>

      <!-- Card Grid -->
      <div id="card-grid" class="grid grid-cols-2 gap-4 md:gap-6 min-h-[250px] relative z-10">
      </div>

      <!-- Controls -->
      <div class="mt-12 flex flex-col sm:flex-row items-center justify-center gap-4 relative z-10">
        <button id="btn-shuffle"
          class="group flex items-center gap-3 px-8 py-4 rounded-full 
                 bg-gradient-to-r from-teal-500 to-cyan-600 
                 text-white font-bold text-lg shadow-xl shadow-cyan-500/30 
                 hover:shadow-cyan-500/50 hover:scale-105 active:scale-95 transition-all">
          <svg class="w-5 h-5 group-hover:rotate-180 transition-transform duration-500" fill="none"
            stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5"
              d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
          </svg>
          Acak Kartu
        </button>

        <button id="btn-reset"
          class="flex items-center gap-2 px-8 py-4 rounded-full 
                 bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-300 
                 font-bold border-2 border-slate-200 dark:border-slate-700 
                 hover:bg-slate-200 dark:hover:bg-slate-700 transition-all">
          â†º Reset
        </button>
      </div>

    </div>
  </div>
</section>



  <!-- Materi -->
  <main id="materi" class="relative pt-32 pb-20 md:pt-48 md:pb-32 overflow-hidden bg-transparent" data-aos="fade-up">
    <!-- Dekorasi Latar Belakang (Dihapus untuk Global BG) -->


    <div class="max-w-7xl mx-auto px-4 sm:px-6 relative">
      <div class="bg-white/40 dark:bg-slate-800/40 backdrop-blur-xl rounded-[2.5rem] md:rounded-[4rem] p-6 md:p-16 border border-white/60 dark:border-slate-700/50 shadow-2xl shadow-primary-900/5 dark:shadow-black/20 overflow-hidden relative">
        
        <!-- Accent Top Bar -->
        <div class="absolute top-0 left-0 w-full h-3 
                  bg-gradient-to-r from-blue-600 via-teal-500 to-emerald-500"></div>

        <div class="text-center mb-12 md:mb-16">
          <h2 class="text-3xl md:text-5xl font-black text-slate-800 dark:text-white mb-4 tracking-tight">
            Pilih <span class="text-transparent bg-clip-text bg-gradient-to-r from-primary-600 to-teal-500">Materi</span> Membaca
          </h2>
          <div class="h-1.5 w-24 bg-gradient-to-r from-primary-500 to-teal-400 rounded-full mx-auto"></div>
        </div>

        <div class="scrollbar-thin overflow-y-auto max-h-[600px] md:max-h-[500px] pr-2">
          <div id="materi-grid" class="grid grid-cols-2 md:grid-cols-3 gap-4 md:gap-10 pb-4">
            <div class="p-10 text-center col-span-full opacity-50">â³ Memuat Materi...</div>
          </div><!-- End Grid -->
        </div>
      </div><!-- End Large Box Wrapper -->
    </div><!-- End Container -->
  </main>
      </div><!-- End Large Box Wrapper -->
    </div><!-- End Container -->
  </main>


    <!-- ===============================
     ğŸ“š PERPUSTAKAAN E-BOOK
================================== -->
    <section id="library" class="scroll-mt-28 max-w-6xl mx-auto px-4 py-8 md:py-12 mb-12">
      
      <div class="relative bg-white dark:bg-slate-800 
                  rounded-[2.5rem] 
                  border-4 border-slate-200 dark:border-slate-700 
                  shadow-xl overflow-hidden 
                  p-6 md:p-10">

        <!-- Accent Top Bar -->
        <div class="absolute top-0 left-0 w-full h-2 
                  bg-gradient-to-r from-teal-400 via-emerald-500 to-green-500"></div>

        <!-- HEADER + FILTER -->
        <div class="grid grid-cols-1 md:grid-cols-[1fr_auto] gap-6 items-end mb-6 relative z-10">

          <!-- Title -->
          <div class="text-center md:text-left">
            <h2 class="text-2xl md:text-3xl font-extrabold text-slate-800 dark:text-white
                  flex items-center justify-center md:justify-start gap-3">
              <span class="p-2 bg-indigo-100 dark:bg-indigo-900/40 rounded-xl
                      text-indigo-600 dark:text-indigo-400">
                ğŸ“š
              </span>
              Digital Library
            </h2>
            <p class="text-xs md:text-sm text-slate-500 dark:text-slate-400 mt-1 font-medium">
              Pilih dan baca koleksi buku Bahasa Arab favoritmu
            </p>
          </div>

          <!-- Filter (Sticky on Mobile) -->
          <div class="sticky top-[72px] z-30
              flex gap-2 p-2 overflow-x-auto no-scrollbar
              bg-slate-100/90 dark:bg-slate-900/80 backdrop-blur
              rounded-2xl border border-slate-200 dark:border-slate-700">

            <button class="ebook-filter-btn snap-start whitespace-nowrap
                px-5 py-2.5 rounded-xl text-sm font-bold
                bg-white dark:bg-slate-800
                text-slate-700 dark:text-slate-200
                shadow-sm border border-slate-200 dark:border-slate-700 hover:bg-teal-50 dark:hover:bg-slate-700" data-level="ALL">
              Semua
            </button>

            <button
              class="ebook-filter-btn snap-start whitespace-nowrap px-4 py-2 rounded-xl text-xs md:text-sm font-bold text-slate-500 dark:text-slate-400 hover:bg-white dark:hover:bg-slate-800 transition"
              data-level="MTs Kelas 7">Kelas 7</button>

            <button
              class="ebook-filter-btn snap-start whitespace-nowrap px-4 py-2 rounded-xl text-xs md:text-sm font-bold text-slate-500 dark:text-slate-400 hover:bg-white dark:hover:bg-slate-800 transition"
              data-level="MTs Kelas 8">Kelas 8</button>

            <button
              class="ebook-filter-btn snap-start whitespace-nowrap px-4 py-2 rounded-xl text-xs md:text-sm font-bold text-slate-500 dark:text-slate-400 hover:bg-white dark:hover:bg-slate-800 transition"
              data-level="MTs Kelas 9">Kelas 9</button>

            <button
              class="ebook-filter-btn snap-start whitespace-nowrap px-4 py-2 rounded-xl text-xs md:text-sm font-bold text-slate-500 dark:text-slate-400 hover:bg-white dark:hover:bg-slate-800 transition"
              data-level="Novel Arab">Novel Islam</button>

            <button
              class="ebook-filter-btn snap-start whitespace-nowrap px-4 py-2 rounded-xl text-xs md:text-sm font-bold text-slate-500 dark:text-slate-400 hover:bg-white dark:hover:bg-slate-800 transition"
              data-level="Kisah Islami">Kisah Islami</button>
          </div>
        </div>

        <!-- LIST E-BOOK -->
        <div class="relative bg-slate-50 dark:bg-slate-900/40
            rounded-3xl border border-slate-200 dark:border-slate-800
            p-4 md:p-6 z-10">

          <div id="ebook-list" class="
      grid
      grid-cols-2
      sm:grid-cols-3
      md:grid-cols-4
      lg:grid-cols-5
      gap-4 md:gap-6
      max-h-[70vh]
      overflow-y-auto
      pr-2
      pr-2

    ">

            <!-- Placeholder Loading -->
            <div class="aspect-[3/4]
                    bg-slate-200/70 dark:bg-slate-800
                    rounded-2xl animate-pulse"></div>

            <div class="aspect-[3/4]
                    bg-slate-200/70 dark:bg-slate-800
                    rounded-2xl animate-pulse"></div>

            <div class="aspect-[3/4]
                    bg-slate-200/70 dark:bg-slate-800
                    rounded-2xl animate-pulse"></div>

          </div>
        </div>

      </div> <!-- End Wrapper Card -->
    </section>




    <!-- DASHBOARD SISWA LOGIN -->
    <section id="dashboard-siswa" class="scroll-mt-28 w-full max-w-4xl mx-auto px-4 py-8 md:py-16 mb-10" data-aos="fade-right">

      <article
        class="bg-white dark:bg-slate-800 rounded-2xl md:rounded-3xl shadow-2xl border border-slate-100 dark:border-slate-700 overflow-hidden transform transition-all hover:scale-[1.01]">

        <div
          class="relative bg-gradient-to-br from-blue-600 to-indigo-800 text-white py-8 md:py-12 text-center overflow-hidden">
          <div class="absolute top-0 left-0 w-32 h-32 bg-white/10 rounded-full -ml-16 -mt-16 blur-2xl"></div>
          <div class="absolute bottom-0 right-0 w-24 h-24 bg-blue-400/20 rounded-full -mr-12 -mb-12 blur-xl"></div>

          <div class="relative z-10 flex flex-col items-center px-4">
            <div
              class="w-12 h-12 md:w-16 md:h-16 bg-white/20 backdrop-blur-md rounded-xl md:rounded-2xl flex items-center justify-center mb-3 shadow-inner border border-white/20">
              <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
                class="text-yellow-300 md:hidden">
                <path d="M22 10v6M2 10l10-5 10 5-10 5z" />
                <path d="M6 12v5c3 3 9 3 12 0v-5" />
              </svg>
              <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"
                class="text-yellow-300 hidden md:block">
                <path d="M22 10v6M2 10l10-5 10 5-10 5z" />
                <path d="M6 12v5c3 3 9 3 12 0v-5" />
              </svg>
            </div>
            <h3 class="text-xl md:text-3xl font-black italic uppercase tracking-tight text-white">
              Dashboard Siswa
            </h3>
            <p class="text-blue-50 text-[11px] md:text-sm mt-1 max-w-[220px] md:max-w-none font-medium opacity-90">
              Akses materi interaktif, kuis harian, dan pantau progresmu.
            </p>
          </div>
        </div>

        <div
          class="p-6 md:p-12 flex flex-col items-center text-center space-y-6 md:space-y-8 bg-slate-50/30 dark:bg-slate-800">

          <div class="space-y-2">
            <p class="text-slate-700 dark:text-slate-300 text-sm md:text-lg leading-relaxed max-w-2xl px-4">
              Selamat datang kembali! Yuk, lanjutkan belajarmu hari ini agar Maharah Qira'ah-mu semakin lancar.
            </p>
            <div
              class="flex flex-wrap items-center justify-center gap-x-4 gap-y-1 text-[10px] md:text-xs font-bold text-slate-400 uppercase tracking-wider pt-2">
              <span>ğŸ“– Materi Sesi</span>
              <span>ğŸ“ Kuis Interaktif</span>
              <span>ğŸ“Š Cek Skor</span>
            </div>
          </div>

          <div class="w-full md:w-auto">
            <a href="dashboard-siswa.html" class="group relative flex items-center justify-center gap-3 
                  bg-blue-600 hover:bg-blue-700 text-white font-black uppercase tracking-widest
                  px-8 py-4 md:py-5 rounded-xl md:rounded-2xl shadow-lg shadow-blue-500/30 
                  transition-all active:scale-95 text-sm md:text-base overflow-hidden">

              <span class="text-lg md:text-xl">ğŸ”“</span>
              <span>Masuk Dashboard Siswa</span>

              <svg xmlns="http://www.w3.org/2000/svg"
                class="w-4 h-4 md:w-5 md:h-5 group-hover:translate-x-1 transition-transform" fill="none"
                viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5m0 0l-5 5m5-5H6" />
              </svg>
            </a>
          </div>

          <div class="flex flex-col items-center gap-2">
            <p class="text-[10px] md:text-xs text-slate-400 font-medium italic">
              *Pastikan kamu sudah terdaftar untuk menyimpan progres belajar.
            </p>
          </div>

        </div>

      </article>
    </section>


    <!-- DASBORD GURU LOGIN -->
    <section id="dashboard-guru" class="w-full max-w-4xl mx-auto px-4 py-8 md:py-16 mb-10" data-aos="fade-left">

      <article
        class="bg-white dark:bg-slate-800 rounded-2xl md:rounded-3xl shadow-xl border border-slate-100 dark:border-slate-700 overflow-hidden transform transition-all hover:scale-[1.01]">

        <div
          class="relative bg-gradient-to-br from-emerald-600 to-teal-800 text-white py-8 md:py-12 text-center overflow-hidden">
          <div class="absolute top-0 right-0 w-32 h-32 bg-white/10 rounded-full -mr-16 -mt-16 blur-2xl"></div>

          <div class="relative z-10 flex flex-col items-center px-4">
            <div
              class="w-12 h-12 md:w-16 md:h-16 bg-white/20 backdrop-blur-md rounded-xl md:rounded-2xl flex items-center justify-center mb-3 shadow-inner border border-white/20">
              <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="text-emerald-100 md:hidden">
                <rect x="3" y="11" width="18" height="11" rx="2" ry="2" />
                <path d="M7 11V7a5 5 0 0 1 10 0v4" />
              </svg>
              <svg xmlns="http://www.w3.org/2000/svg" width="36" height="36" viewBox="0 0 24 24" fill="none"
                stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                class="text-emerald-100 hidden md:block">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
                <path d="M12 8v4" />
                <path d="M12 16h.01" />
              </svg>
            </div>
            <h3 class="text-xl md:text-3xl font-black italic uppercase tracking-tight">
              Dashboard Guru
            </h3>
            <p class="text-emerald-50 text-[11px] md:text-sm mt-1 max-w-[220px] md:max-w-none font-medium opacity-90">
              Manajemen data siswa, e-book, dan koreksi tugas.
            </p>
          </div>
        </div>

        <div
          class="p-6 md:p-12 flex flex-col items-center text-center space-y-6 md:space-y-8 bg-slate-50/30 dark:bg-slate-800">

          <div class="space-y-2">
            <p class="text-slate-700 dark:text-slate-300 text-sm md:text-lg leading-relaxed max-w-2xl px-4">
              Akses terbatas untuk tenaga pengajar. Silakan masuk untuk mengelola progres belajar siswa.
            </p>
            <div
              class="flex flex-wrap items-center justify-center gap-x-4 gap-y-1 text-[10px] md:text-xs font-bold text-slate-400 uppercase tracking-wider pt-2">
              <span>ğŸ“ Data Siswa</span>
              <span>ğŸ“š Kelola E-Book</span>
              <span>ğŸ“¥ Cek Tugas</span>
            </div>
          </div>

          <div class="w-full md:w-auto">
            <a href="dashboard-guru.html" class="group relative flex items-center justify-center gap-3 
                  bg-emerald-600 hover:bg-emerald-700 text-white font-black uppercase tracking-widest
                  px-8 py-4 md:py-5 rounded-xl md:rounded-2xl shadow-lg shadow-emerald-500/30 
                  transition-all active:scale-95 text-sm md:text-base overflow-hidden">

              <span class="text-lg md:text-xl">ğŸ”</span>
              <span>Masuk Dashboard Guru</span>

              <svg xmlns="http://www.w3.org/2000/svg"
                class="w-4 h-4 md:w-5 md:h-5 group-hover:translate-x-1 transition-transform" fill="none"
                viewBox="0 0 24 24" stroke="currentColor" stroke-width="3">
                <path stroke-linecap="round" stroke-linejoin="round" d="M13 7l5 5m0 0l-5 5m5-5H6" />
              </svg>
            </a>
          </div>

          <div class="flex flex-col items-center gap-2">
            <p class="text-[10px] md:text-xs text-slate-400 font-medium italic">
              *Halaman ini memerlukan otentikasi admin/guru.
            </p>
          </div>

        </div>

      </article>
    </section>




    <script>feather.replace()</script>

  </main>

  <!-- Tentang -->
  <!-- Tentang -->
  <section id="tentang" class="max-w-7xl mx-auto px-4 pb-16 md:pb-24" data-aos="zoom-in" data-aos-duration="1000">
    <div class="relative bg-white dark:bg-slate-800 rounded-[2.5rem] shadow-2xl border-4 border-slate-100 dark:border-slate-700 overflow-hidden">
      
      <!-- Background Decorations -->
      <div class="absolute top-0 right-0 w-32 h-32 bg-teal-500/10 rounded-full -mr-16 -mt-16 blur-2xl"></div>
      <div class="absolute bottom-0 left-0 w-40 h-40 bg-cyan-500/10 rounded-full -ml-20 -mb-20 blur-3xl"></div>

      <div class="relative p-8 md:p-14">
        <!-- Header Section -->
        <div class="flex items-center gap-4 mb-8">
          <div class="p-3 bg-teal-100 dark:bg-teal-900/30 rounded-2xl text-teal-600 dark:text-teal-400 shadow-sm">
            <i data-feather="info" class="w-6 h-6"></i>
          </div>
          <h2 class="text-2xl md:text-4xl font-black text-slate-800 dark:text-white tracking-tight leading-tight">
            Visi <span class="text-teal-600 dark:text-teal-400">Tarbiyyat Al-Lughah</span>
          </h2>
        </div>

        <!-- Main Description -->
        <div class="space-y-6 md:space-y-8">
          <p class="text-slate-700 dark:text-slate-300 leading-relaxed text-base md:text-xl font-medium">
            <span class="text-teal-600 dark:text-teal-400 font-black">Ø§Ù„ØªØ±Ø¨ÙŠØ© Ø§Ù„Ù„ØºÙˆÙŠØ©</span> (Tarbiyyat al-Lughah) adalah ekosistem 
            <span class="italic underline decoration-teal-500/30">Next-Gen Interactive Learning</span> yang dirancang khusus 
            untuk merevolusi cara siswa MTs menguasai 
            <span class="font-bold text-slate-900 dark:text-white px-1">Maharah Qira'ah</span> (Kemampuan Membaca).
          </p>

          <!-- Methodology / Steps -->
          <div class="bg-slate-50 dark:bg-slate-900/50 rounded-3xl p-6 md:p-8 border-2 border-slate-100 dark:border-slate-700 shadow-inner">
            <p class="text-[10px] md:text-xs font-black text-slate-400 dark:text-slate-500 uppercase tracking-[0.2em] mb-6">Metode Belajar Interaktif:</p>
            
            <div class="grid grid-cols-1 sm:grid-cols-3 gap-6">
              <!-- Step 1 -->
              <div class="space-y-3">
                <div class="flex items-center gap-3">
                  <span class="w-8 h-8 flex items-center justify-center bg-teal-600 text-white rounded-xl text-xs font-black shadow-lg shadow-teal-500/20">1</span>
                  <span class="text-sm md:text-base font-bold dark:text-slate-100">Kosakata Visual</span>
                </div>
                <p class="text-xs text-slate-500 dark:text-slate-400 leading-relaxed">Penguasaan mufradat melalui kartu kosakata 3D yang interaktif.</p>
              </div>

              <!-- Step 2 -->
              <div class="space-y-3">
                <div class="flex items-center gap-3">
                  <span class="w-8 h-8 flex items-center justify-center bg-teal-600 text-white rounded-xl text-xs font-black shadow-lg shadow-teal-500/20">2</span>
                  <span class="text-sm md:text-base font-bold dark:text-slate-100">Qira'ah Digital</span>
                </div>
                <p class="text-xs text-slate-500 dark:text-slate-400 leading-relaxed">Praktik membaca teks terstruktur dengan dukungan multimedia.</p>
              </div>

              <!-- Step 3 -->
              <div class="space-y-3">
                <div class="flex items-center gap-3">
                  <span class="w-8 h-8 flex items-center justify-center bg-teal-600 text-white rounded-xl text-xs font-black shadow-lg shadow-teal-500/20">3</span>
                  <span class="text-sm md:text-base font-bold dark:text-slate-100">Game Edukasi</span>
                </div>
                <p class="text-xs text-slate-500 dark:text-slate-400 leading-relaxed">Evaluasi pemahaman melalui tantangan gamifikasi yang seru.</p>
              </div>
            </div>
          </div>

          <p class="text-slate-600 dark:text-slate-400 text-sm md:text-base leading-relaxed">
            Melalui integrasi teknologi AI dan desain yang berpusat pada pengguna, kami menghadirkan pengalaman belajar yang 
            lebih alami, sistematis, dan tentu saja tidak membosankan bagi generasi Z.
          </p>
        </div>

        <!-- Developer Card -->
        <div class="mt-12 pt-10 border-t-2 border-slate-100 dark:border-slate-700">
          <div class="flex flex-col md:flex-row items-center justify-between gap-6">
            <div class="flex items-center gap-4 group">
              <div class="relative">
                <div class="absolute inset-0 bg-teal-500 blur-md opacity-20 group-hover:opacity-40 transition-opacity"></div>
                <div class="relative w-14 h-14 md:w-16 md:h-16 rounded-2xl bg-gradient-to-tr from-teal-600 to-cyan-600 flex items-center justify-center text-white text-xl font-black shadow-xl ring-4 ring-white dark:ring-slate-800">
                  MA
                </div>
              </div>
              <div class="text-center md:text-left">
                <p class="text-base md:text-xl font-black text-slate-900 dark:text-white leading-none mb-1">Muh. Aprizal</p>
                <div class="flex items-center gap-2">
                  <span class="px-2 py-0.5 bg-teal-50 dark:bg-teal-900/30 text-[10px] font-bold text-teal-600 dark:text-teal-400 rounded-md uppercase">Developer</span>
                  <span class="text-slate-400">|</span>
                  <span class="text-[10px] md:text-xs text-slate-500 dark:text-slate-400 font-medium">PBA IAIN BONE</span>
                </div>
              </div>
            </div>
            
            <div class="inline-flex items-center gap-2 px-5 py-2 bg-slate-100 dark:bg-slate-900/80 backdrop-blur rounded-full border border-slate-200 dark:border-slate-700">
              <span class="flex h-2 w-2">
                <span class="animate-ping absolute inline-flex h-2 w-2 rounded-full bg-teal-400 opacity-75"></span>
                <span class="relative inline-flex rounded-full h-2 w-2 bg-teal-500"></span>
              </span>
              <span class="text-[10px] font-black text-slate-500 dark:text-slate-400 uppercase tracking-widest">
                Skripsi Original Project
              </span>
            </div>
          </div>
        </div>

      </div>
    </div>
  </section>

  <!-- Footer -->
  <footer class="relative bg-white/80 dark:bg-slate-950/80 backdrop-blur-md border-t border-slate-200 dark:border-slate-800 transition-colors pt-16 pb-8">
    <div class="absolute top-0 left-0 w-full h-1.5 bg-gradient-to-r from-teal-600 via-cyan-500 to-teal-500 opacity-80"></div>

    <div class="max-w-7xl mx-auto px-6">
      <div class="grid grid-cols-1 md:grid-cols-3 gap-12 mb-16">
        
        <!-- Brand & About -->
        <div class="space-y-6">
          <div class="flex flex-col gap-1">
            <span class="text-2xl font-black tracking-tighter text-slate-800 dark:text-white uppercase italic">
              Tarbiyyat <span class="text-teal-600 dark:text-teal-400">al-Lughah</span>
            </span>
            <div class="h-1.5 w-16 bg-teal-600 dark:bg-teal-400 rounded-full"></div>
          </div>
          <p class="text-slate-500 dark:text-slate-400 leading-relaxed font-medium text-sm">
            Media Pembelajaran Interaktif berbasis website yang dirancang khusus untuk meningkatkan kemampuan membaca Bahasa Arab siswa MTs melalui metode yang terstruktur dan menyenangkan.
          </p>
          <div class="flex items-center gap-4">
            <div class="flex items-center gap-2 px-3 py-1 bg-teal-50 dark:bg-teal-900/20 rounded-full border border-teal-100 dark:border-teal-800/50">
              <span class="w-1.5 h-1.5 rounded-full bg-teal-500 animate-pulse"></span>
              <span class="text-[10px] font-bold text-teal-600 dark:text-teal-400 uppercase tracking-wider">Project Skripsi</span>
            </div>
          </div>
        </div>

        <!-- Tech Stack & Credits -->
        <div class="space-y-6">
          <h4 class="text-sm font-black uppercase tracking-widest text-slate-900 dark:text-white">Development Stack</h4>
          <div class="grid grid-cols-1 gap-4">
            <div class="space-y-2">
              <p class="text-[10px] font-bold text-slate-400 dark:text-slate-500 uppercase tracking-widest">Tools & Editors</p>
              <p class="text-xs text-slate-600 dark:text-slate-300 font-semibold leading-relaxed">
                VS Code â€¢ Google Antigravity â€¢ Sublime Text
              </p>
            </div>
            <div class="space-y-2">
              <p class="text-[10px] font-bold text-slate-400 dark:text-slate-500 uppercase tracking-widest">Backend & Infrastructure</p>
              <p class="text-xs text-slate-600 dark:text-slate-300 font-semibold leading-relaxed">
                Firebase Backend â€¢ Google Cloud Console â€¢ Git â€¢ Node.js
              </p>
            </div>
            <div class="space-y-2">
              <p class="text-[10px] font-bold text-slate-400 dark:text-slate-500 uppercase tracking-widest">Powered by AI Technology</p>
              <p class="text-xs text-slate-600 dark:text-slate-300 font-semibold leading-relaxed">
                ChatGPT â€¢ Gemini â€¢ GitHub Copilot
              </p>
            </div>
          </div>
        </div>

        <!-- Contact & Location -->
        <div class="space-y-6">
          <h4 class="text-sm font-black uppercase tracking-widest text-slate-900 dark:text-white">Hubungi Kami</h4>
          <div class="space-y-4">
            <a href="tel:082266862306" class="flex items-center gap-3 group">
              <div class="p-2 rounded-lg bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 group-hover:bg-teal-600 group-hover:text-white transition-all">
                <i data-feather="phone" class="w-4 h-4"></i>
              </div>
              <span class="text-sm font-bold text-slate-600 dark:text-slate-300 group-hover:text-teal-600 transition-colors">0822 6686 2306</span>
            </a>
            <a href="mailto:icalafrizal550790@gmail.com" class="flex items-center gap-3 group">
              <div class="p-2 rounded-lg bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400 group-hover:bg-teal-600 group-hover:text-white transition-all">
                <i data-feather="mail" class="w-4 h-4"></i>
              </div>
              <span class="text-sm font-bold text-slate-600 dark:text-slate-300 group-hover:text-teal-600 transition-colors text-wrap break-all">icalafrizal550790@gmail.com</span>
            </a>
            <div class="flex items-start gap-3 group">
              <div class="p-2 rounded-lg bg-slate-100 dark:bg-slate-800 text-slate-600 dark:text-slate-400">
                <i data-feather="map-pin" class="w-4 h-4"></i>
              </div>
              <div class="space-y-1">
                <span class="text-sm font-bold text-slate-600 dark:text-slate-300">Alamat</span>
                <p class="text-xs text-slate-400 italic">(Alamat akan segera diperbarui)</p>
              </div>
            </div>
          </div>
        </div>

      </div>

      <!-- Copyright Bottom -->
      <div class="pt-8 border-t border-slate-200 dark:border-slate-800 flex flex-col md:flex-row items-center justify-between gap-4">
        <p class="text-[11px] text-slate-400 font-bold uppercase tracking-widest">
          Â© 2025 Tarbiyyat al-Lughah. Handcrafted with <span class="text-rose-500 animate-pulse text-lg">â™¥</span> by Muh. Aprizal
        </p>
        <div class="flex items-center gap-6">
          <span class="text-[10px] font-black text-slate-300 dark:text-slate-700 uppercase tracking-tighter">PBA IAIN Bone</span>
        </div>
      </div>
    </div>
  </footer>

  <!-- Trigger mengambang -->
  <button id="a2hs-fab" class="hidden fixed right-4 bottom-4 z-[60] rounded-2xl px-4 py-3 font-semibold shadow-xl
         bg-primary-600 text-white hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-300
         transition">
    â†—ï¸ Pasang Aplikasi
  </button>

  <!-- Backdrop -->
  <div id="a2hs-backdrop" class="hidden fixed inset-0 z-50 bg-black/40 backdrop-blur-sm"></div>

  <!-- Bottom sheet -->
  <div id="a2hs-sheet" class="pointer-events-none fixed inset-x-0 bottom-0 z-50 translate-y-full opacity-0
            transition-all duration-300 ease-out">
    <div class="pointer-events-auto mx-auto w-full max-w-md rounded-t-3xl border border-primary-100
           bg-white shadow-2xl">
      <div class="px-5 pt-4 pb-3 flex items-center gap-3">
        <div class="size-10 shrink-0 grid place-items-center rounded-xl bg-primary-100 text-primary-700">
          <svg viewBox="0 0 24 24" class="size-6" fill="currentColor">
            <path
              d="M3 5.5A2.5 2.5 0 0 1 5.5 3H20a1 1 0 0 1 1 1v14.5a.5.5 0 0 1-.79.407L18 17.25l-2.21 1.657a.5.5 0 0 1-.79-.407V5H5.5A1.5 1.5 0 0 0 4 6.5V19a1 1 0 0 1-2 0V6.5A2.5 2.5 0 0 1 3 5.5Z" />
          </svg>
        </div>
        <div class="min-w-0">
          <h3 class="text-base font-semibold text-primary-800">Pasang â€œTarbiyyat al-Lughahâ€</h3>
          <p class="text-sm text-slate-600">Akses cepat dari layar utama, mode offline, dan tampilan penuh layar.</p>
        </div>
      </div>

      <!-- iOS hint (hanya ditampilkan di iOS) -->
      <div id="ios-hint" class="hidden mx-5 mb-3 rounded-xl bg-slate-50 px-4 py-3 text-sm text-slate-700">
        Di Safari: ketuk <span class="font-semibold">Share</span> â†’ <span class="font-semibold">Add to Home
          Screen</span>.
      </div>

      <div class="px-5 pb-5 flex gap-3">
        <button id="a2hs-cancel" class="flex-1 rounded-xl border border-slate-200 bg-white px-4 py-3 font-semibold text-slate-700
               hover:bg-slate-50 transition">Nanti</button>
        <button id="a2hs-confirm" class="flex-1 rounded-xl bg-primary-600 px-4 py-3 font-semibold text-white hover:bg-primary-700
               transition">Pasang</button>
      </div>
    </div>
  </div>

  <!-- Snackbar -->
  <div id="a2hs-snackbar" class="pointer-events-none fixed left-1/2 bottom-6 z-[70] -translate-x-1/2
            hidden rounded-xl bg-slate-900 text-white px-4 py-2 text-sm shadow-lg">
    Aplikasi terpasang ğŸ‰
  </div>



  <!-- Feather Icons -->
  <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
  <script>document.addEventListener('DOMContentLoaded', () => feather.replace());</script>


  <!-- Aktifkan mode global (1 angka untuk seluruh situs) -->
  <!-- <script>
  window.PRESENCE_OPTIONS = { mode: "global" };
</script>


<script type="module" src="./assets/presence.js"></script> -->




  <!-- Logika Tombol -->
  <script>
    (() => {
      const FAB = document.getElementById('a2hs-fab');
      const SHEET = document.getElementById('a2hs-sheet');
      const BACKDROP = document.getElementById('a2hs-backdrop');
      const BTN_OK = document.getElementById('a2hs-confirm');
      const BTN_CANCEL = document.getElementById('a2hs-cancel');
      const SNACK = document.getElementById('a2hs-snackbar');
      const IOS_HINT = document.getElementById('ios-hint');

      let deferredPrompt = null;
      const NAG_KEY = 'a2hs:nag';
      const COOLDOWN = 1000 * 60 * 60 * 24 * 3; // 3 hari

      const isStandalone = window.matchMedia?.('(display-mode: standalone)').matches || window.navigator.standalone;
      const isiOS = (() => {
        const ua = navigator.userAgent;
        const iOS = /iPad|iPhone|iPod/.test(ua) || (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
        return iOS && !isStandalone;
      })();

      const showFab = () => FAB.classList.remove('hidden');
      const hideFab = () => FAB.classList.add('hidden');

      const openSheet = () => {
        BACKDROP.classList.remove('hidden');
        SHEET.classList.remove('opacity-0', 'translate-y-full');
        SHEET.classList.add('opacity-100', 'translate-y-0');
      };
      const closeSheet = () => {
        SHEET.classList.add('opacity-0', 'translate-y-full');
        setTimeout(() => BACKDROP.classList.add('hidden'), 250);
      };
      const toast = (msg, ms = 2400) => {
        SNACK.textContent = msg;
        SNACK.classList.remove('hidden');
        setTimeout(() => SNACK.classList.add('hidden'), ms);
      };

      if (isStandalone) hideFab();

      window.addEventListener('appinstalled', () => {
        hideFab(); localStorage.removeItem(NAG_KEY); toast('Berhasil dipasang ğŸ‰');
      });

      window.addEventListener('beforeinstallprompt', (e) => {
        console.log('âœ… Event beforeinstallprompt aktif'); // debug log
        e.preventDefault();
        deferredPrompt = e;
        const last = Number(localStorage.getItem(NAG_KEY) || 0);
        if (Date.now() - last < COOLDOWN) return;
        showFab(); // pastikan baris ini aktif
      });


      FAB.addEventListener('click', () => {
        IOS_HINT.classList.toggle('hidden', !isiOS);
        hideFab();          // â¬…ï¸ sembunyikan tombol dulu
        openSheet();
      });


      BACKDROP.addEventListener('click', closeSheet);
      BTN_CANCEL.addEventListener('click', () => {
        localStorage.setItem(NAG_KEY, Date.now().toString());
        closeSheet(); hideFab();
      });

      BTN_OK.addEventListener('click', async () => {
        if (isiOS) {
          localStorage.setItem(NAG_KEY, Date.now().toString());
          closeSheet(); hideFab();
          toast('Buka menu Share â†’ Add to Home Screen');
          return;
        }
        if (!deferredPrompt) { toast('Belum eligible untuk dipasang'); return; }

        closeSheet(); hideFab();
        deferredPrompt.prompt();
        const { outcome } = await deferredPrompt.userChoice;
        deferredPrompt = null;

        if (outcome === 'accepted') toast('Memasang aplikasiâ€¦');
        else {
          localStorage.setItem(NAG_KEY, Date.now().toString());
          toast('Kamu bisa memasang nanti dari menu browser');
        }
      });

      if (isiOS) {
        const last = Number(localStorage.getItem(NAG_KEY) || 0);
        if (Date.now() - last >= COOLDOWN) showFab();
      }
    })();
  </script>




  <script>
    document.addEventListener('DOMContentLoaded', () => {
      const input = document.getElementById('search-input');
      const results = document.getElementById('search-results');

      if (!input || !results) return;

      // Gabungkan VOCABS + QUESTIONS
      const fromQuestions = (window.QUESTIONS || [])
        .map(q => ({ ar: q?.ar, id: q?.id }))
        .filter(x => x && typeof x.ar === 'string' && typeof x.id === 'string');

      const DATA = (window.VOCABS || []).concat(fromQuestions);

      // Hilangkan harakat Arab
      const stripHarakat = s =>
        (s || '').replace(/[\u064B-\u065F\u0670]/g, '');

      function render(list) {
        results.innerHTML = '';
        if (!list.length) {
          results.innerHTML = `
  <div class="flex flex-col items-center justify-center py-12 px-4 animate-fade-in">
    <div class="p-4 bg-slate-100 dark:bg-slate-800/50 rounded-full mb-4">
      <svg class="w-8 h-8 text-slate-400 dark:text-slate-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2" />
      </svg>
    </div>
    
    <h3 class="text-slate-700 dark:text-slate-200 font-bold text-lg mb-1">
      Kata tidak ditemukan
    </h3>
    
    <p class="text-slate-400 dark:text-slate-500 text-sm text-center max-w-xs leading-relaxed">
      Coba periksa ejaan kata atau cari kosakata lainnya dalam Bahasa Arab atau Indonesia.
    </p>
  </div>
`;
          return;
        }

        list.slice(0, 30).forEach(v => {
          const row = document.createElement('div');
          row.className = `
  group flex items-center justify-between px-6 py-4 
  border-b border-slate-100 dark:border-slate-800/50 
  hover:bg-blue-50/50 dark:hover:bg-slate-700/30 
  cursor-pointer transition-all duration-200
`;

          row.innerHTML = `
  <div class="flex flex-col">
    <span class="text-[10px] font-black uppercase tracking-widest text-slate-400 group-hover:text-blue-500 transition-colors">Arti</span>
    <span class="text-base md:text-lg font-bold text-slate-700 dark:text-slate-200 capitalize">${v.id}</span>
  </div>

  <div class="flex flex-col items-end">
    <span class="text-[10px] font-black uppercase tracking-widest text-slate-400 mb-1">Bahasa Arab</span>
    <span class="font-arab text-2xl md:text-3xl text-blue-600 dark:text-blue-400 leading-relaxed drop-shadow-sm">
      ${v.ar}
    </span>
  </div>
`;
          results.appendChild(row);
        });
      }

      function doSearch() {
        const q = input.value.trim();
        if (!q) {
          results.innerHTML = '';
          return;
        }

        const qLatin = q.toLowerCase();
        const qArab = stripHarakat(q);

        const hits = DATA.filter(v =>
          stripHarakat(v.ar).includes(qArab) ||
          v.id.toLowerCase().includes(qLatin)
        );

        render(hits);
      }

      input.addEventListener('input', doSearch);

      input.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
          e.preventDefault();
          doSearch();
        }
      });
    });
  </script>

  <!-- JS UNTUK LOGIKA KARTU FLIP KOSAKATA -->

  
  <script type="module">
     import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";
     import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";

     // Config Firebase (Publik/Client)
     const flashcardConfig = {
      apiKey: "AIzaSyAo4Hed-LHh2YIdkOE9PEinMGjG9UwAMUQ",
      authDomain: "tarbiyyat-lughah-presence.firebaseapp.com",
      projectId: "tarbiyyat-lughah-presence",
      databaseURL: "https://tarbiyyat-lughah-presence-default-rtdb.asia-southeast1.firebasedatabase.app",
      storageBucket: "tarbiyyat-lughah-presence.firebasestorage.app",
     };

     const flashcardApp = initializeApp(flashcardConfig);
     const flashcardDb = getFirestore(flashcardApp);

    (async () => {
      /* =====================
         GUARD DOM
      ===================== */
      const grid = document.getElementById('card-grid');
      const btnSh = document.getElementById('btn-shuffle');
      const btnRs = document.getElementById('btn-reset');
      const modeAR = document.getElementById('mode-ar');
      const modeID = document.getElementById('mode-id');

      if (!grid || !btnSh || !btnRs || !modeAR || !modeID) {
        return;
      }

      /* =====================
         AMBIL DATA
      ===================== */
      let raw = [];
      grid.innerHTML = '<div class="col-span-full text-center py-10 opacity-50"><p>â³ Mengambil kartu...</p></div>';

      try {
          const snap = await getDocs(collection(flashcardDb, "flashcards"));
          if(!snap.empty) {
              snap.forEach(d => raw.push(d.data()));
          } else {
              // Fallback ke data statis jika DB kosong (misal belum migrasi)
              if(window.VOCABS) {
                  raw = window.VOCABS;
                  console.log("Fallback to static VOCABS");
              }
          }
      } catch(e) {
          console.error("Gagal load flashcards:", e);
          if(window.VOCABS) raw = window.VOCABS; // Fallback
      }

      // Filter valid data
      const uniq = [];
      const seen = new Set();
      
      const cleanRaw = raw.filter(v => typeof v?.ar === 'string' && typeof v?.id === 'string');

      for (const v of cleanRaw) {
        const key = `${v.ar}|${v.id}`;
        if (!seen.has(key)) {
          seen.add(key);
          uniq.push(v);
        }
      }

      if (!uniq.length) {
        grid.innerHTML = '<div class="col-span-full text-center py-10 opacity-50"><p>âŒ Tidak ada data kartu.</p></div>';
        return;
      }

      /* =====================
         STATE
      ===================== */
      let mode = 'ar';          // 'ar' | 'id'
      let currentSlice = [];

      /* =====================
         UTIL
      ===================== */
      const shuffle = arr => {
        const a = arr.slice();
        for (let i = a.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [a[i], a[j]] = [a[j], a[i]];
        }
        return a;
      };

      const pick4 = () => shuffle(uniq).slice(0, 4);

      const stripHarakat = s => (s || '').replace(/[\u064B-\u065F\u0670]/g, '');

      const sizeClassForArabic = ar => {
        const len = stripHarakat(ar).length;
        if (len > 25) return 'text-lg md:text-2xl';     // Sangat Panjang (Kalimat)
        if (len > 15) return 'text-xl md:text-3xl';     // Panjang (Waalaikumsalam)
        if (len > 8)  return 'text-2xl md:text-4xl';    // Sedang
        return 'text-4xl md:text-5xl';                  // Pendek (Default)
      };

      const sizeClassForIndo = id => {
        const len = (id || '').length;
        if (len > 36) return 'text-[10px] md:text-xs';
        if (len > 22) return 'text-xs md:text-sm';
        if (len > 14) return 'text-sm md:text-lg';
        return 'text-lg md:text-xl';
      };

      /* =====================
         RENDER
      ===================== */
      function renderCards(items) {
        grid.innerHTML = '';

        items.forEach((v, index) => {
          const front = mode === 'ar'
            ? `<div class="font-arab ${sizeClassForArabic(v.ar)} font-bold text-slate-800 dark:text-white text-center leading-[1.8] drop-shadow-sm px-2">
      ${v.ar}
     </div>`
            : `<div class="${sizeClassForIndo(v.id)} font-black text-slate-700 dark:text-slate-200 text-center leading-snug uppercase tracking-tight px-2">
      ${v.id}
     </div>`;

          const back = mode === 'ar'
            ? `<div class="${sizeClassForIndo(v.id)} font-black text-white text-center leading-snug uppercase tracking-tight px-2 drop-shadow-md">
      ${v.id}
     </div>`
            : `<div class="font-arab ${sizeClassForArabic(v.ar)} font-bold text-white text-center leading-[1.8] drop-shadow-md px-2">
      ${v.ar}
     </div>`;

          const card = document.createElement('button');
          card.type = 'button';
          card.className = 'card3d w-full select-none focus:outline-none';
          card.setAttribute('aria-label', 'kartu kosakata');
          card.setAttribute('data-aos', 'zoom-in');
          card.setAttribute('data-aos-delay', index * 100); // Stagger animation

          card.innerHTML = `
  <div class="card3d-inner group">
    
    <div class="card-face bg-white dark:bg-slate-800 border-2 border-slate-100 dark:border-slate-700 shadow-xl p-4 overflow-hidden">
      <div class="flex flex-col items-center justify-center h-full">
        <span class="text-[9px] font-black uppercase tracking-widest text-blue-500 mb-1.5 md:mb-6">Kosakata</span>
        <div class="w-full flex items-center justify-center leading-tight">
          ${front}
        </div>
      </div>
    </div>

    <div class="card-face card-back bg-gradient-to-br from-emerald-500 to-emerald-700 shadow-2xl p-4 text-white">
      <div class="flex flex-col items-center justify-center h-full">
        <span class="text-[9px] font-black uppercase tracking-widest text-emerald-100 opacity-70 mb-1.5 md:mb-6">Arti</span>
        <div class="w-full flex items-center justify-center leading-tight">
          ${back}
        </div>
      </div>
    </div>

  </div>
`;

          card.addEventListener('click', () => {
            card.classList.toggle('flipped');
          });

          grid.appendChild(card);
        });
        
        setTimeout(() => { if (window.AOS) window.AOS.refresh(); }, 300);
      }

      function rerender() {
        currentSlice = pick4();
        renderCards(currentSlice);
      }

      /* =====================
         EVENTS
      ===================== */
      btnSh.addEventListener('click', rerender);

      btnRs.addEventListener('click', () => {
        grid.querySelectorAll('.card3d')
          .forEach(el => el.classList.remove('flipped'));
      });

      function setMode(newMode) {
        mode = newMode;
        
        const activeClass = 'px-6 py-2.5 rounded-xl text-xs md:text-sm font-black bg-white dark:bg-teal-600 text-teal-700 dark:text-white shadow-md scale-100 transition-all duration-300';
        const inactiveClass = 'px-6 py-2.5 rounded-xl text-xs md:text-sm font-bold text-slate-500 dark:text-slate-400 hover:text-slate-700 dark:hover:text-slate-200 transition-all duration-300';

        if (mode === 'ar') {
          modeAR.className = activeClass;
          modeID.className = inactiveClass;
        } else {
          modeAR.className = inactiveClass;
          modeID.className = activeClass;
        }

        renderCards(currentSlice);
      }

      modeAR.addEventListener('click', () => setMode('ar'));
      modeID.addEventListener('click', () => setMode('id'));

      /* =====================
         INIT
      ===================== */
      rerender();
    })();
  </script>

  <!-- HARAKAT GAME JS (FIRESTORE) - Logic for OLD UI above -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getFirestore, collection, getDocs, onSnapshot } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

    const harakatConfig = {
      apiKey: "AIzaSyAo4Hed-LHh2YIdkOE9PEinMGjG9UwAMUQ",
      authDomain: "tarbiyyat-lughah-presence.firebaseapp.com",
      projectId: "tarbiyyat-lughah-presence",
      databaseURL: "https://tarbiyyat-lughah-presence-default-rtdb.asia-southeast1.firebasedatabase.app",
      storageBucket: "tarbiyyat-lughah-presence.firebasestorage.app",
    };

    const harakatApp = initializeApp(harakatConfig);
    const harakatDb = getFirestore(harakatApp);

    // STATE
    let questions = [];
    let currentQuestion = null;

    // DOM Elements for OLD UI
    const oldQuestionEl = document.getElementById('harakat-question');
    const oldInputEl = document.getElementById('harakat-input');
    const oldFeedbackEl = document.getElementById('harakat-feedback');
    const shuffleBtn = document.getElementById('shuffle-question');
    
    // Load question to OLD UI
    function loadQuestionOld() {
        if (questions.length === 0) {
            if (oldQuestionEl) oldQuestionEl.innerText = "Memuat soal...";
            return;
        }
        const rand = Math.floor(Math.random() * questions.length);
        currentQuestion = questions[rand];
        if (oldQuestionEl) oldQuestionEl.innerText = currentQuestion.word || currentQuestion.plain || "...";
        if (oldInputEl) oldInputEl.value = '';
    }

    // LOAD DATA
    const q = collection(harakatDb, "harakat_questions");
    onSnapshot(q, (snap) => {
        questions = [];
        snap.forEach(d => questions.push(d.data()));
        // Auto-load first question for old UI when data arrives
        if (questions.length > 0) {
            loadQuestionOld();
        }
    });

    // Check answer from OLD UI
    window.checkHarakatAnswer = function() {
        if (!currentQuestion) {
            loadQuestionOld();
            return;
        }
        const userAns = oldInputEl?.value?.trim() || '';
        if (!userAns) {
            if (oldFeedbackEl) {
                oldFeedbackEl.classList.remove('hidden', 'bg-green-100', 'text-green-700');
                oldFeedbackEl.classList.add('bg-amber-100', 'text-amber-700');
                oldFeedbackEl.innerText = "â— Jawaban masih kosong";
            }
            return;
        }

        if (userAns === currentQuestion.answer) {
            // Show success popup
            showCorrectPopup();
            
            // Reset state input
            if(oldInputEl) {
               oldInputEl.classList.remove('border-red-500', 'ring-2', 'ring-red-500/20', 'animate-shake');
               oldInputEl.classList.add('border-emerald-500', 'ring-2', 'ring-emerald-500/20');
            }

            setTimeout(() => {
                hideCorrectPopup();
                if(oldInputEl) {
                   oldInputEl.classList.remove('border-emerald-500', 'ring-2', 'ring-emerald-500/20');
                }
                loadQuestionOld();
            }, 1400);
        } else {
            // Error with Shake & Red Border (No Text Alert)
            if (oldInputEl) {
                // Reset animation class to allow re-triggering
                oldInputEl.classList.remove('animate-shake');
                void oldInputEl.offsetWidth; // force reflow
                
                oldInputEl.classList.add('border-red-500', 'ring-2', 'ring-red-500/20', 'animate-shake');
                
                // Remove error style after interaction or timer? 
                // Let's keep the red border until user modifies input, or remove it after delay.
                // For now, let's remove shake after animation ends, but keep border until typing?
                // Or just timeout like before.
                setTimeout(() => {
                    oldInputEl.classList.remove('animate-shake');
                    // Optional: remove red border too? 
                    // oldInputEl.classList.remove('border-red-500', 'ring-2', 'ring-red-500/20');
                }, 500); 
                
                // Remove error styling on next input
                const clearError = () => {
                   oldInputEl.classList.remove('border-red-500', 'ring-2', 'ring-red-500/20');
                   oldInputEl.removeEventListener('input', clearError);
                };
                oldInputEl.addEventListener('input', clearError);
            }
        }
    };

    // Popup helper functions
    const correctPopup = document.getElementById('harakat-correct-popup');
    
    function showCorrectPopup() {
        if (correctPopup) correctPopup.classList.add('active');
    }

    function hideCorrectPopup() {
        if (correctPopup) correctPopup.classList.remove('active');
    }

    // Shuffle button for OLD UI
    shuffleBtn?.addEventListener('click', () => {
        loadQuestionOld();
    });

    // =============================================
    // KEYBOARD TOGGLE & INPUT LOGIC
    // (Wait for arabic-keyboard.js to inject the element)
    // =============================================
    function initKeyboardListeners() {
        const toggleKeyboardBtn = document.getElementById('toggle-keyboard');
        const keyboardEl = document.getElementById('arabic-keyboard');

        if (!keyboardEl) {
            // Keyboard not yet injected, retry after 200ms
            setTimeout(initKeyboardListeners, 200);
            return;
        }

        console.log("Keyboard element found, attaching listeners...");

        toggleKeyboardBtn?.addEventListener('click', () => {
            keyboardEl?.classList.toggle('hidden');
            toggleKeyboardBtn.classList.toggle('active');
        });

        // Keyboard key clicks
        keyboardEl?.addEventListener('click', (e) => {
            const btn = e.target.closest('.key-arab, .key-harakat');
            if (!btn) return;
            const char = btn.dataset.char;
            if (char && oldInputEl) {
                oldInputEl.value += char;
                oldInputEl.focus();
            }
        });

        // Backspace
        document.getElementById('key-backspace')?.addEventListener('click', () => {
            if (oldInputEl) {
                oldInputEl.value = oldInputEl.value.slice(0, -1);
                oldInputEl.focus();
            }
        });

        // Space
        document.getElementById('key-space')?.addEventListener('click', () => {
            if (oldInputEl) {
                oldInputEl.value += ' ';
                oldInputEl.focus();
            }
        });

        // Enter
        document.getElementById('key-enter')?.addEventListener('click', () => {
            window.checkHarakatAnswer();
        });
    }

    // Start polling for keyboard element
    initKeyboardListeners();

    // Enter key on input
    oldInputEl?.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') window.checkHarakatAnswer();
    });
  </script>



  <!-- LOGIC BUKU E-BOOK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import {
      getFirestore,
      collection,
      getDocs,
      query,
      orderBy
    } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

    /* ğŸ”¥ FIREBASE CONFIG */
    const firebaseConfig = {
      apiKey: "AIzaSyAo4Hed-LHh2YIdkOE9PEinMGjG9UwAMUQ",
      authDomain: "tarbiyyat-lughah-presence.firebaseapp.com",
      projectId: "tarbiyyat-lughah-presence",
      databaseURL: "https://tarbiyyat-lughah-presence-default-rtdb.asia-southeast1.firebasedatabase.app",
      storageBucket: "tarbiyyat-lughah-presence.firebasestorage.app",
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    /* ===============================
       STATE GLOBAL
    ================================ */
    let ALL_EBOOKS = [];
    let ACTIVE_LEVEL = "ALL";

    /* ===============================
       LOAD EBOOK
    ================================ */
    async function loadEbooks() {
      const wrap = document.getElementById("ebook-list");
      if (!wrap) return;

      wrap.innerHTML = "â³ Memuat e-book...";

      try {
        const q = query(
          collection(db, "ebooks"),
          orderBy("createdAt", "desc")
        );

        const snap = await getDocs(q);
        ALL_EBOOKS = snap.docs.map(d => d.data());

        renderEbooks();

      } catch (err) {
        console.error(err);
        wrap.innerHTML = "âŒ Gagal memuat e-book";
      }
    }

    /* ===============================
       RENDER EBOOK
    ================================ */
    function renderEbooks() {
      const wrap = document.getElementById("ebook-list");
      wrap.innerHTML = "";

      const filtered = ACTIVE_LEVEL === "ALL"
        ? ALL_EBOOKS
        : ALL_EBOOKS.filter(e => e.level === ACTIVE_LEVEL);

      if (filtered.length === 0) {
        wrap.innerHTML = "ğŸ“­ Tidak ada e-book di kategori ini";
        return;
      }

      filtered.forEach((e, i) => {
        wrap.innerHTML += `
  <div class="group bg-teal-50/50 dark:bg-slate-800 rounded-xl md:rounded-2xl shadow-md hover:shadow-xl border border-teal-200 dark:border-slate-700 p-2 md:p-4 transition-all duration-300 hover:-translate-y-1 flex flex-col" data-aos="fade-up" data-aos-delay="${i * 50}">
    
    <div class="relative aspect-[3/4] mb-2 md:mb-4 overflow-hidden rounded-lg bg-white dark:bg-slate-900 flex items-center justify-center border border-teal-100 dark:border-slate-700">
      <img src="${e.coverUrl}" 
           alt="${e.title_id}"
           class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-500">
      
      <div class="absolute top-1 right-1 bg-red-600 text-white text-[8px] md:text-[10px] font-bold px-1.5 py-0.5 rounded shadow-sm">
        PDF
      </div>
    </div>

    <div class="flex-1 mb-2 text-center">
      <h3 class="font-bold text-slate-800 dark:text-white text-[10px] md:text-sm line-clamp-2 leading-tight mb-1" dir="rtl">
        ${e.title_ar}
      </h3>
      <p class="text-[8px] md:text-xs text-slate-500 dark:text-slate-400 italic line-clamp-1">
        ${e.title_id}
      </p>
    </div>

    <a href="${e.fileUrl}" target="_blank"
       class="flex items-center justify-center gap-1.5 bg-teal-600 hover:bg-teal-700 text-white rounded-lg py-1.5 md:py-2.5 text-[9px] md:text-sm font-bold transition-all active:scale-95">
      <svg class="w-3 h-3 md:w-4 md:h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>
      Baca Sekarang
    </a>
  </div>
`;
      });
      
      setTimeout(() => { if (window.AOS) window.AOS.refresh(); }, 300);
    }

    /* ===============================
       FILTER BUTTON
    ================================ */
    document.querySelectorAll(".ebook-filter-btn").forEach(btn => {
      btn.addEventListener("click", () => {

        // hapus active dari semua tombol
        document.querySelectorAll(".ebook-filter-btn").forEach(b => {
          b.classList.remove("bg-white", "text-slate-700");
          b.classList.add("bg-slate-200", "dark:bg-slate-700");
        });

        // aktifkan tombol yang diklik
        btn.classList.add("bg-white", "text-slate-700");
        btn.classList.remove("bg-slate-200", "dark:bg-slate-700");

        ACTIVE_LEVEL = btn.dataset.level;
        renderEbooks();
      });
    });

    /* ===============================
       INIT
    ================================ */
    loadEbooks();
  </script>

  <!-- LOGIKA TOGLE HUMBERGER -->
  <script>
    // ... script dark mode anda ...

    // LOGIKA MENU MOBILE
    const btn = document.getElementById('mobile-menu-btn');
    const menu = document.getElementById('mobile-menu');
    const links = document.querySelectorAll('.mobile-link');

    // 1. Toggle Menu saat tombol hamburger diklik
    btn.addEventListener('click', () => {
      menu.classList.toggle('hidden');
    });

    // 2. Tutup menu otomatis saat salah satu link diklik
    links.forEach(link => {
      link.addEventListener('click', () => {
        menu.classList.add('hidden');
      });
    });

    // 3. Tutup menu jika layar di-resize ke ukuran Desktop (opsional, untuk kerapian)
    window.addEventListener('resize', () => {
      if (window.innerWidth >= 768) { // 768px adalah breakpoint 'md' tailwind
        menu.classList.add('hidden');
      }
    });
  </script>

  <!-- JS UNTUK DARKMODE -->
  <script>
    const toggle = document.getElementById('themeToggle');
    const root = document.documentElement;

    // Load preferensi
    if (localStorage.theme === 'dark') {
      root.classList.add('dark');
      toggle.textContent = 'â˜€ï¸';
    }

    toggle.addEventListener('click', () => {
      root.classList.toggle('dark');
      const isDark = root.classList.contains('dark');
      toggle.textContent = isDark ? 'â˜€ï¸' : 'ğŸŒ™';
      localStorage.theme = isDark ? 'dark' : 'light';
    });
  </script>

  <!-- UNTUK KEYBOARD -->
  <script>
    const keyboardElement = document.getElementById('arabic-keyboard');
    const bodyElement = document.body;

    // Fungsi untuk Menampilkan/Menyembunyikan Keyboard
    function toggleKeyboard(show) {
      const wrapper = document.getElementById("harakat-game-wrapper");
      const keyboard = document.getElementById("arabic-keyboard");
      const gameCardSection = document.getElementById("harakat-board"); // Target Board Soal & Jawaban (Bukan Section Utama)

      if (!wrapper || !keyboard) return;

      const willShow = show !== undefined
        ? show
        : keyboard.classList.contains("hidden");

      if (willShow) {
        keyboard.classList.remove("hidden");

        // 1. Ambil tinggi keyboard asli + sedikit extra
        const kbHeight = keyboard.querySelector(".keyboard-wrapper")?.offsetHeight || 300;

        // 2. Beri padding bottom extra supaya bisa discroll full (keyboard gak nutupin konten terbawah)
        wrapper.style.paddingBottom = (kbHeight + 50) + "px";

        // 3. Scroll Cerdas: Taruh "Bagian Atas Kartu Game" di "Bagian Atas Layar"
        //    Supaya user lihat Soal & Jawaban, bukan cuma inputnya doang.
        if (gameCardSection) {
          // Ambil posisi elemen relatif terhadap viewport
          const rect = gameCardSection.getBoundingClientRect();
          const scrollTop = window.pageYOffset || document.documentElement.scrollTop;

          // Target: Offset lebih besar supaya "Soal" tidak kepotong header
          const headerOffset = 120;
          const targetPosition = rect.top + scrollTop - headerOffset;

          window.scrollTo({
            top: targetPosition,
            behavior: "smooth"
          });
        }

      } else {
        keyboard.classList.add("hidden");
        wrapper.style.paddingBottom = "0";
      }
    }


    // Contoh penggunaan:
    // Pasang event listener ini di input field Anda
    document.querySelector('.arabic-input').addEventListener('focus', () => {
      toggleKeyboard(true);
    });

    // Script untuk tombol keyboard (Insert Char)
    function insertChar(char) {
      const input = document.querySelector('.arabic-input');
      input.value += char;
      // input.focus(); // HATI-HATI: Jangan auto-focus terus menerus di mobile, keyboard asli bisa muncul.
    }

    // Script Delete
    function deleteChar() {
      const input = document.querySelector('.arabic-input');
      input.value = input.value.slice(0, -1);
    }
  </script>



  <!-- SWAL for Alerts -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <!-- BANK SOAL SUSUN KATA -->
  <script type="module" src="./assets/js/sentence-game.js"></script>

  <!-- BANK SOAL BERI HARAKAT -->
  <script src="assets/js/arabic-keyboard.js"></script>








  <!-- LOGIC RENDER MATERI (GLOBAL + DYNAMIC) -->
  <script type="module">
    import { fetchThemes } from './assets/js/content-registry.js';
    
    document.addEventListener("DOMContentLoaded", async () => {
       const grid = document.getElementById("materi-grid");
       if(!grid) return;

       const REGISTRY = await fetchThemes();
       grid.innerHTML = ""; 
       


       // Dynamic Cards
       Object.values(REGISTRY).forEach(theme => {
           // Check Visibility (Default to true if undefined, but if strictly false then hide)
           if (theme.isVisible === false) return;

           const colors = {
               emerald: "from-emerald-500 to-teal-700",
               lime: "from-lime-500 to-emerald-600",
               rose: "from-rose-500 to-orange-600",
               amber: "from-amber-500 to-yellow-600",
               slate: "from-slate-600 to-slate-800",
               blue: "from-blue-500 to-indigo-600"
           }[theme.color || 'blue'];
           
           const btnColor = {
               emerald: "bg-emerald-600 hover:bg-emerald-700 shadow-emerald-500/30",
               lime: "bg-lime-600 hover:bg-lime-700 shadow-lime-500/30",
               rose: "bg-rose-600 hover:bg-rose-700 shadow-rose-500/30",
               amber: "bg-amber-600 hover:bg-amber-700 shadow-amber-500/30",
               slate: "bg-slate-700 hover:bg-slate-800 shadow-slate-500/30",
               blue: "bg-blue-600 hover:bg-blue-700 shadow-blue-500/30"
           }[theme.color || 'blue'];

           grid.innerHTML += `
            <article class="group bg-white dark:bg-slate-800 rounded-2xl md:rounded-3xl shadow-md hover:shadow-xl border border-slate-100 dark:border-slate-700 overflow-hidden transition-all duration-300 hover:-translate-y-1" data-aos="fade-up" data-aos-delay="100">
                <div class="relative bg-gradient-to-br ${colors} dark:to-slate-900 px-3 py-6 md:px-6 md:py-8 text-center overflow-hidden">
                <div class="absolute -top-10 -right-10 w-24 h-24 md:w-32 md:h-32 bg-white/10 rounded-full blur-2xl"></div>
                <h3 class="arabic-text text-2xl md:text-4xl font-bold text-white mb-1.5 md:mb-2 leading-relaxed drop-shadow-sm" style="font-family: 'Amiri', serif;">
                    ${theme.arTitle}
                </h3>
                <div class="inline-block px-2 py-0.5 md:px-3 md:py-1 rounded-full bg-white/20 backdrop-blur-sm border border-white/10">
                    <p class="text-[10px] md:text-xs font-bold text-white tracking-wider uppercase">${theme.title}</p>
                </div>
                </div>

                <div class="p-3 md:p-8 space-y-3 md:space-y-6 flex flex-col h-full">
                <p class="text-slate-600 dark:text-slate-400 text-xs md:text-sm leading-relaxed line-clamp-3 md:line-clamp-none">
                    ${theme.desc}
                </p>

                <div class="space-y-3 mt-auto">
                    <a href="vocabulary.html?theme=${theme.id}"
                    class="flex items-center justify-center gap-2 md:gap-3 w-full ${btnColor} text-white py-2 md:py-3.5 px-3 md:px-6 rounded-xl md:rounded-2xl shadow-lg transition-all transform active:scale-95 font-bold text-[10px] md:text-sm">
                    <svg xmlns="http://www.w3.org/2000/svg" class="w-3 h-3 md:w-5 md:h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
                    Mulai
                    </a>
                </div>
                </div>
            </article>
           `;
       });
       
       // Refresh AOS setelah konten dimuat
       setTimeout(() => {
         if(window.AOS) window.AOS.refresh();
       }, 500);

    });
  </script>
  <script>
    if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('./sw.js')
          .then(registration => {
            console.log('ServiceWorker registration successful with scope: ', registration.scope);
          }, err => {
            console.log('ServiceWorker registration failed: ', err);
          });
      });
    }
  </script>
  <!-- Initialize AOS -->
  <script src="assets/vendor/aos/aos.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      AOS.init({
        once: true,
        duration: 800,
        offset: 50, // Dikurangi agar animasi lebih mudah muncul
        easing: 'ease-out-cubic',
        anchorPlacement: 'top-bottom', // Animasi mulai saat bagian atas elemen menyentuh bagian bawah layar
      });
      
      // Force refresh setelah window load (untuk memastikan gambar/konten selesai load)
      window.addEventListener('load', () => {
        AOS.refresh();
      });
    });
  </script>
</body>
</html>